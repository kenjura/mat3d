<!DOCTYPE html>
<html lang="en">
<head>

	<title>Mat3d</title>

	<link rel="stylesheet" href="css/main.css" />

	<script src="js/utils.js"></script>

	<script src="js/3d/3d.js"></script>
	<script src="js/3d/init.js"></script>
	<script src="js/3d/setupControls.js"></script>
	<script src="js/3d/render.js"></script>

	<script src="js/3d/three.js"></script>
	<script src="js/3d/stats.js"></script>
	<script src="js/3d/FirstPersonControls.js"></script>

</head>
<body ng-controller="mainCtrl">

	reminder: clara.io

	<div id="container"></div>

	<div id="compass">
		<div id="compassNeedle"> </div>
	</div>

	<div id="dashboard" style="">
		<table>
		<tr>
			<th>mx</th>
			<td id="mx"></td>
			<th>mrx</th>
			<td id="mrx"></td>
			<th>x</th>
			<td id="x"></td>
			<th>rx</th>
			<td id="rx"></td>
		</tr>
		<tr>

			<th>my</th>
			<td id="my"></td>
			<th>mry</th>
			<td id="mry"></td>
			<th>y</th>
			<td id="y"></td>
			<th>ry</th>
			<td id="ry"></td>
		</tr>
		<tr>
			<th>mz</th>
			<td id="mz"></td>
			<th>mrz</th>
			<td id="mrz"></td>
			<th>z</th>
			<td id="z"></td>
			<th>rz</th>
			<td id="rz"></td>
		</tr>
		</table>
	</div>

	<div class="leftPanel">
		<ul>
			<li>W - forward</li>
			<li>A - left</li>
			<li>S - backward</li>
			<li>D - right</li>
			<li>Space - up</li>
			<li>C - down</li>
		</ul>

		<p>Left click on a grid tile to rotate around that tile.</p>
		<p>Left click on a token to enter token mode.</p>
		<p>In token mode, the arrow keys move the token.</p>
		<p>Press ESC to unselect token.</p>
		<p>Right click and drag to move camera.</p>

		<p>
			<button id="add-token">add a token</button>
			<button id="start-server">start server</button>
			<button id="connect-to-server">connect to server</button>
		</p>
	</div>

	<script src="https://unpkg.com/peerjs@1.3.1/dist/peerjs.js"></script>
	<script src="/js/multi/multi.js"></script>

	<script>
		document.querySelector('#add-token').addEventListener('click', addToken);
		document.querySelector('#start-server').addEventListener('click', startServer);
		document.querySelector('#connect-to-server').addEventListener('click', connectToServer);

		window.globals = {


		}

		function addToken() {
			const x = Math.floor(Math.random()*20) - 10;
			const y = Math.floor(Math.random()*20) - 10;
			const z = 0;
			const r = Math.floor(Math.random()*256);
			const g = Math.floor(Math.random()*256);
			const b = Math.floor(Math.random()*256);
			const color = (r << 16) + (g << 8) + b;
			const randId = Math.floor(Math.random()*100000);
			const name = `new-token-${randId}`;
			const args = { name, color, x, y, z };
			window.globals.renderToken(args);
		}
		function startServer() {
			multi.serve();
		}
		function connectToServer() {
			multi.client();
		}
	</script>

</body>
</html>
